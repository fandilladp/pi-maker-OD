#!/bin/bash

echo "#############################################"
echo "## Copy Scripts "
echo "#############################################"

# run custom setup script inside context of image

if [[ -n "${SCRIPT_DIR}" ]]; then
  if [[ -d "/tmp/${SCRIPT_DIR}" ]]; then
    for file in "/tmp/${SCRIPT_DIR}"/*;do
        install -Dm755 "$file" "mnt/${file}"
        echo "added script: ${file}"
    done
  fi
fi

if [[ -n "${COPY_DIR}" ]]; then
  if [[ -d "/tmp/${COPY_DIR}" ]]; then
      echo "adding directory: /tmp/${COPY_DIR}"
      cp -rf "/tmp/${COPY_DIR}" "mnt/tmp/${COPY_DIR}"
  fi
fi


if [[ -f "/tmp/setup" ]]; then
  install -Dm755 "/tmp/setup" "mnt/tmp/setup"
  echo "added script: /tmp/setup"
fi

