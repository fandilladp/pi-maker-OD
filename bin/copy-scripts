#!/bin/bash

SCRIPT_DIR=${SCRIPT_DIR:-install}
COPY_DIR=${COPY_DIR:-""}

echo "#############################################"
echo "## Copy Scripts "
echo "#############################################"

# run custom setup script inside context of image
if [[ -d "/tmp/${SCRIPT_DIR}" ]]; then
  for file in "/tmp/${SCRIPT_DIR}"/*;do
      install -Dm755 "$file" "mnt/${file}"
      echo "added script: ${file}"
  done
fi

if [[ ! "${COPY_DIR}" == null ]]; then
    if [[ -d "/tmp/${COPY_DIR}" ]]; then
        echo "adding directory: /tmp/${COPY_DIR}"
        cp -rf "/tmp/${COPY_DIR}" "mnt/tmp/${COPY_DIR}"
    fi
fi


if [[ -f "/tmp/setup" ]]; then
  install -Dm755 "/tmp/setup" "mnt/tmp/setup"
  echo "added script: /tmp/setup"
fi

